<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" contents="Slutty Ladies Overplay Obedient Trying Have Epic Sex">

    <title>sloothes</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/bootbox-dialoges.css">
    <link rel="stylesheet" href="/css/side-panels.css">
    <link rel="stylesheet" href="/css/messg.css" >
    <link rel="stylesheet" href="/css/spectrum.css">
    <link rel="stylesheet" href="/css/colorpicker.css">
    <link rel="stylesheet" href="/css/spinner.css">
    <link rel="stylesheet" href="/css/jquery-ui.css">
    <link rel="stylesheet" href="/css/alerts.css">
    <link rel="stylesheet" href="/css/panel-ui.css">
    <link rel="stylesheet" href="/css/anywhere3d.css">
    <link rel="stylesheet" href="/css/jquery.Jcrop.css">
    <link rel="stylesheet" href="/css/menu-menubar.css">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/style.css">

    <script src="/sw.js"></script>
    <script src="/js/loadjs.min.js"></script>

</head>

<body>

<style>

    #content div ul li {
        cursor: pointer;
        margin-left:15px;
    }
    #right-side-content {
        position:absolute; left:25px; top:60px; right:10px; bottom:40px; 
        padding: 0px 20px 0px 20px; overflow:auto; 
    }
    a.none-deco:focus,
    a.none-deco:hover, 
    a.none-deco:active, 
    a.none-deco:visited {
        color:#55a5ec;
        text-decoration:none;
    }

</style>

<div id="panel" class="collapsed">
    <h1><a href="/home" class="none-deco">Sloothes</a></h1>
    <a id="expandButton" href="#">
        <span></span>
        <span></span>
        <span></span>
    </a>
    <div class="filterBlock" >
        <input type="text" id="filterInput" placeholder="Type to filter"/>
        <a href="#" id="clearFilterButton" >x</a>
    </div>
    <div id="content"></div>
</div>

<section class="mbr-section" id="body-section">

    <iframe id="viewer" src="/tradecenter"></iframe>

</section>

<script>

    var list = {

        "Pages": {

        /*
            "SiteMap": [
                ["Home", "/home"],
            ],
        */

            "Scenes": [
                ["Home", "/scene"],
                ["Center", "/tradecenter"],
                ["Elevators", "/elevators"],
            ],

            "Viewers": [
                ["3D Online", "/3DViewer/website"],
                ["OBJ Viewer", "/OBJViewer"],
                ["FBX Viewer", "/FBXViewer"],
            ],

            "Editors": [
                ["Html Editor", "/htmlEditor"],
                ["Photo Editor", "//www.photopea.com"],
                ["Threejs Editor", "/three/r78/editor"],
            ],

            "Products": [
                ["My products", "/products-catalog"],
            ],

        /*
            "Some fun...": [
            //  ["Ping Pong", "//oos.moxiecode.com/js_webgl/ping_pong"],
                ["flamingo", "//threejsfundamentals.org/threejs/background.html"],
            ],
        */

        },

    };

    var pages = {};

    for ( var section in list ) {
        pages[ section ] = {};
        for ( var category in list[ section ] ) {
            pages[ section ][ category ] = {};
            for ( var i = 0; i < list[ section ][ category ].length; i ++ ) {
                var page = list[ section ][ category ][ i ];
                pages[ section ][ category ][ page[ 0 ] ] = page[ 1 ];
            }
        }
    }

</script>

<script>

    var panel = document.getElementById( 'panel' );
    var viewer = document.getElementById( 'viewer' );

    var expandButton = document.getElementById( 'expandButton' );
    expandButton.addEventListener( 'click', function ( event ) {
        panel.classList.toggle( 'collapsed' );
        event.preventDefault();
    } );

    var filterInput = document.getElementById( 'filterInput' );
    var clearFilterButton = document.getElementById( 'clearFilterButton' );

    var DELIMITER = '/';
    var MEMBER_DELIMITER = '.';
    var nameCategoryMap = {};
    var sections = [];

    var content = document.getElementById( 'content' );

    for ( var section in list ) {

        var h2 = document.createElement( 'h2' );
        h2.textContent = section;

        content.appendChild( h2 );

        for ( var category in list[ section ] ) {

            var div = document.createElement( 'div' );

            var h3 = document.createElement( 'h3' );
            h3.textContent = category;

            div.appendChild( h3 );

            var ul = document.createElement( 'ul' );
            div.appendChild( ul );

            for ( var i = 0; i < list[ section ][ category ].length; i ++ ) {

                var page = list[ section ][ category ][ i ];

                var li = document.createElement( 'li' );
                var a = document.createElement( 'a' );
            //  a.setAttribute( "href", "#" );

                (function( s, c, p ) {
                    a.addEventListener( "click", function( e ) {
                        debugMode && console.log({
                            "section": s,
                            "category": c,
                            "page": p,
                        });
                        viewer.src = goTo( s, c, p[0] );
                        e.preventDefault();
                    })
                })( section, category, page );

                a.textContent = page[0];
                li.appendChild( a );
                ul.appendChild( li );

                nameCategoryMap[page[0]] = {
                    section: section,
                    category: category,
                    name: page[0],
                    element: a
                };

            }

            content.appendChild( div );
            sections.push( ul );

        }
    }

    panel.appendChild( content )

    function layoutList() {

        sections.forEach( function( el ) {
            var collapsed = true;
            Array.prototype.slice.apply( el.children ).forEach( function( item ) {
                if( !item.classList.contains( 'filtered' ) ) {
                    collapsed = false;
                    return;
                }
            } );
            if( collapsed ) {
                el.parentElement.classList.add( 'filtered' );
            } else {
                el.parentElement.classList.remove( 'filtered' );
            }
        } );
    }

    filterInput.addEventListener( 'input', function( e ) {
        updateFilter();
    } );

    clearFilterButton.addEventListener( 'click', function( e ) {
        filterInput.value = '';
        updateFilter();
        e.preventDefault();
    } );

    function updateFilter() {

        var exp = new RegExp( filterInput.value, 'gi' );
        for( var j in nameCategoryMap ) {
            var res = nameCategoryMap[ j ].name.match( exp );
            if( res && res.length > 0 ) {
                nameCategoryMap[ j ].element.parentElement.classList.remove( 'filtered' );
                var str = nameCategoryMap[ j ].name;
                for( var i = 0; i < res.length; i++ ) {
                    str = str.replace( res[ i ], '<b>' + res[ i ] + '</b>' );
                }
                nameCategoryMap[ j ].element.innerHTML = str;
            } else {
                nameCategoryMap[ j ].element.parentElement.classList.add( 'filtered' );
                nameCategoryMap[ j ].element.textContent = nameCategoryMap[ j ].name;
            }
        }
        layoutList();

    }

    function encodeUrl( path ) {

        return path.replace(/\ \/\ /g, '.').replace(/\ /g, '_');

    }

    function decodeUrl( path ) {

        return path.replace(/_/g, ' ').replace(/\./g, ' / ');

    }

//  Page loading.

    function goTo( section, category, name, member ) {
        var parts, location;

    //  Fully resolve links that only provide a name
        if(arguments.length == 1) {

        //  Resolve links of the form 'Class.member'
            if(section.indexOf(MEMBER_DELIMITER) !== -1) {
                parts = section.split(MEMBER_DELIMITER)
                section = parts[0];
                member = parts[1];
            }

            location = nameCategoryMap[section];
            if (!location) return;
            section = location.section;
            category = location.category;
            name = location.name;
        }

        var url = pages[ section ][ category ][ name ];
        //  window.location.pathname = url;

        panel.classList.add( 'collapsed' );
        
        return url;

    }

    function goToHash() {

        var hash = window.location.hash.substring( 1 ).split(DELIMITER);
        var member = hash[2].split(MEMBER_DELIMITER)
        goTo( decodeUrl(hash[0]), decodeUrl(hash[1]), decodeUrl(member[0]), decodeUrl(member.length > 1 ? member[1] : '') );

    }

    window.addEventListener( 'hashchange', goToHash, false );

    if ( window.location.hash.length > 0 ) goToHash();

</script>

<script>
    var jsfiles = [
        "/js/w3.js", 
        "/js/store2.js", 
        "/js/jquery.min.js", 
        "/js/bootstrap.min.js", 
        "/js/bootbox.min.js", 
        "/js/DeviceDetector.js",
    ];
    loadjs( jsfiles, {async: false});
</script>

</body>
</html>

